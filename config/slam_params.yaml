slam_toolbox:
  ros__parameters:

    # ========================================================
    # 1. 動作モードとフレーム設定 (最重要)
    # ========================================================
    odom_frame: odom
    map_frame: map
    base_frame: base_link  # 【変更点】デフォルトはbase_footprintの場合が多いので注意！
    scan_topic: /scan      # LaunchでRemapしていればこのままでOK
    mode: mapping          # 地図を作る時は 'mapping' (位置合わせだけなら 'localization')

    # ========================================================
    # 2. 地図更新のしきい値 (テスト中は小さくする)
    # ========================================================
    # ロボットがこれだけ動かないと地図更新処理が走らない
    minimum_travel_distance: 0.01   # 【推奨】テスト用: 0.5 -> 0.1 (m)
    minimum_travel_heading: 0.01    # 【推奨】テスト用: 0.5 -> 0.1 (rad)
    
    # 処理負荷を下げるための設定
    transform_publish_period: 0.01 # 地図TFの発行周期 (秒)
    map_update_interval: 0.1       # 地図配信の間隔 (秒)
    resolution: 0.05               # グリッドサイズ (5cm)
    
    # LiDARのスペックに合わせる
    max_laser_range: 20.0          # LiDARの最大距離 (m)
    min_laser_range: 0.0           # 最小距離
    
    # ========================================================
    # 3. 内部アルゴリズム設定 (基本はいじらなくてOK)
    # ========================================================
    # Solver Params
    solver_plugin: solver_plugins::CeresSolver
    ceres_linear_solver: SPARSE_NORMAL_CHOLESKY
    ceres_preconditioner: SCHUR_JACOBI
    ceres_trust_strategy: LEVENBERG_MARQUARDT
    ceres_dogleg_type: TRADITIONAL_DOGLEG
    ceres_loss_function: None

    # Loop Closure (ループ閉じ込み) Params
    do_loop_closing: true
    use_scan_barycenter: true
    check_min_dist_and_heading_precisely: false
    scan_buffer_size: 1
